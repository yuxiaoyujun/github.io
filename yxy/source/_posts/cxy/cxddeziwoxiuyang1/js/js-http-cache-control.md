---
title: '【第9-3章】HTTP请求头和响应头中的no-cache和no-store的区别'
date: 2019-05-17 10:30:35
tags:
  - js
  - lv1
categories:
  - 程序员的自我修养
---
<meta name="referrer" content="no-referrer">

HTTP（Hypertext Transfer Protocol）是一种用于在客户端和服务器之间传输数据的协议。

在HTTP请求头和响应头中，有两个重要的指令：`no-cache`和`no-store`。

这两个指令用于控制**强制缓存**的行为，但它们有不同的作用和效果。

## no-cache

`no-cache`是一个HTTP头部指令，通常出现在**请求头**中，但有时也可以在响应头中找到。它告诉缓存服务器**不要直接使用缓存的副本来响应客户端的请求**，而是需要**先将请求发送到源服务器**，然后**根据源服务器的响应来确定**是否需要更新缓存。

`no-cache`的主要目的是确保客户端始终获取最新的数据，但它仍然允许缓存服务器在源服务器确认数据未更改时提供响应，从而减轻源服务器的负担。

**重点**：

根据[HTTP规范]()，`no-cache` 指令的确切含义是 "**在使用之前必须重新验证**"，而不是 "**不要缓存**"。

这意味着浏览器**可以在本地缓存响应数据**，但在使用之前**必须先发送条件性请求到服务器**，以**验证数据是否仍然有效**。

`no-cache`也**不是禁止浏览器不能缓存**，而是使用浏览器缓存之前，**必须要先到服务器进行验证**。当响应头也使用`no-cache`时，服务器缓存的数据和客户端一样，**需要遵循验证规则**。

详细请看：[RFC 7234](https://datatracker.ietf.org/doc/html/rfc7234#section-5.2.2.2)，我反正是这么理解的。

示例请求头：

```http
GET /example.html HTTP/1.1
Host: www.example.com
Cache-Control: max-age=3600, no-cache

```

比如说当我像上面这么写`cache-control`的话，就会产生本地有缓存，且为3600秒的情况。当我在这3600秒中再次需要数据，我虽然本地有缓存，却需要去源服务器进行校验。

如果我仅仅写了`max-age`，那么这3600秒之内是不会去校验的，直接使用本地缓存做显示了。

## no-store

与`no-cache`不同，`no-store`是一个更为严格的指令，通常**只出现在响应头**中。它告诉缓存服务器**不要在任何情况下存储请求的响应数据**。这意味着缓存服务器不会将响应存储在缓存中，也不会返回存储在缓存中的响应数据。

`no-store`的目的是确保**响应数据不会被存储在任何地方**，包括**客户端的本地缓存**、**中间代理服务器**或其他地方。这对于敏感数据（如银行信息或个人身份信息）非常重要，以防止数据泄露。

示例响应头：

```
HTTP/1.1 200 OK
Cache-Control: no-store
```

## 总结

- `no-cache`要求缓存服务器验证缓存中的数据的有效性，并在需要时从源服务器获取新数据，以确保客户端获取最新数据。
- `no-store`则要求缓存服务器不存储任何响应数据，以确保数据不会被意外泄露。

在选择使用这两个指令时，应根据应用程序的需求和数据的敏感性来确定哪一个更合适。通常情况下，`no-cache`是一个较为常见的选项，因为它可以在减轻服务器负担的同时仍然提供较新的数据。但对于非常敏感的数据，使用`no-store`可能更为安全。

## 补充

**no-cache**的一些其他参数
